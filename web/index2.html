<!DOCTYPE html>
<html>
<head>
    <title>Refresh from url after use data option</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="bootstrap.min.css">
    <link rel="stylesheet" href="bootstrap-table.min.css">
    <script src="jquery.min.js"></script>
    <script src="bootstrap.min.js"></script>
    <script src="bootstrap-table.min.js"></script>

    <link rel="stylesheet" href="CSS3loader/loaders.css">

    <style>
        div.loader .loader-inner {
            position: absolute;
            left: 50%;
            margin: 20px 0 50px -76px;

            text-align: center;
        }
        div.loader>.ball-pulse>div {
            background-color: #2f96b4;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>Refresh from url after use data option(<a href="https://github.com/wenzhixin/bootstrap-table/issues/137" target="_blank">#137</a>).</h1>
    <p><button id="button" class="btn btn-default">Refresh from url</button></p>
    <table id="table" class="table table-bordered">
        <thead>
        <tr>
            <th data-field="mid">ID</th>
            <th data-field="bid">Item Name</th>
            <th data-field="ask">Item Price</th>
            <th data-field="last_price">Item Price</th>
            <th data-field="low">Item Price</th>
			<th data-field="high">Item Price</th>
            <th data-field="volume">Item Price</th>
            <th data-field="timestamp">Item Price</th>
        </tr>
        </thead>
    </table>
</div>
<script>
	var socket = new WebSocket("ws://182.92.150.57:8001");
	socket.onopen = function (event) {
        alert("websocket连接建立成功...");
        socket.send({"mid":"0.0396265","bid":"0.039626","ask":"0.039627","last_price":"0.039626","low":"0.037625","high":"0.04622","volume":"202898.86695984","timestamp":"1509630586.0410173"});
    };
    socket.onclose = function (event) {
        alert("连接关闭");
    };
	
    socket.onmessage = function (event) {
		var $table = $('#table');
		var xdata = [{"mid":"0.01","bid":"0.039626","ask":"0.039627","last_price":"0.039626","low":"0.037625","high":"0.04622","volume":"202898.86695984","timestamp":"1509630586.0410173"}];
		var jsonStr = JSON.stringify(xdata);
		var obj = JSON.parse(jsonStr); 
		alert(jsonStr);
		$table.bootstrapTable({
			data: obj
        });
	};
    
	
/*
	var xdata = [{"mid":"0.0396265","bid":"0.039","ask":"0.03","last_price":"0.039","low":"0.037625","high":"0.04622","volume":"202898.86695984","timestamp":"1509630586.0410173"},{"mid":"0.0396265","bid":"0.039626","ask":"0.039627","last_price":"0.039626","low":"0.037625","high":"0.04622","volume":"202898.86695984","timestamp":"1509630586.0410173"}];
	var jsonStr = JSON.stringify(xdata);
	var obj = JSON.parse(jsonStr); 
		alert(jsonStr);
		$table.bootstrapTable({
			data: obj
        });
		*/
	$('#button').click(function () {
		//socket.send({"mid":"0.0396265","bid":"0.039626","ask":"0.039627","last_price":"0.039626","low":"0.037625","high":"0.04622","volume":"202898.86695984","timestamp":"1509630586.0410173"});
        //$table.bootstrapTable('refresh', {url: 'https://api.bitfinex.com/v1/pubticker/ethbtc'});
    });
    
</script>
</body>
</html>